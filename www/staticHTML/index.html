<!DOCTYPE html>
<html>
<head>
  <title>Landing Page</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      background-color: #3AAFA9;
    }

    .landing {
      width: 800px;
      margin: 0 auto;
      padding: 10px;
      border-radius: 15px;
      border: #2b7a78 1px solid;
      background-color: #def2f1;
    }

    .landing h1 {
      font-size: 34px;
      margin: 10px 0;
    }

    .landing p {
      margin: 5px 0;
    }

    .landing input[type="file"] {
      width: 40%;
      padding: 8px;
      margin: 5px 0;
      border-radius: 10px;
      font-size: 1.5rem;
      border: none !important;
    }

    .landing button {
      width: 35%;
      padding: 10px;
      margin: 5px;
      font-size: 18px;
      cursor: pointer;
      border-radius: 10px;
      border: #2b7a78 1px solid;
      background-color: #b7e1e0;
    }
  </style>
</head>
<body>
<div class="landing">
  <h1>Webserv</h1>
  <div class="row">
    <a href="/bin-cgi/calculator(GetRequest).py?v1=1&v2=1&operator=+"><button>Calculator(GetRequestTester)</button></a>
    <a href="/counter"><button>Counter(PostRequestTester)</button></a>
  </div>

  <div class="row">
      <input type="file" id="fileInput">
      <button id="button">Upload File</button>
      <div id="result"></div>

      <script>
          function sendPostRequest() {
              var button = document.getElementById('button');
              var result = document.getElementById('result');
              var fileInput = document.getElementById('fileInput');

              button.addEventListener('click', async () => {
                  // Get the selected file from the file input
                  var file = fileInput.files[0];

                  // Check if a file was selected
                  if (!file) {
                      result.innerText = 'Please select a file to upload.';
                      return;
                  }
                  // Create a FileReader to read the file contents
                  var reader = new FileReader();

                  reader.onload = async function (event) {
                      var fileContent = event.target.result;

                      // Add the file name with extension and a space to the beginning of the content
                      fileContent = file.name + ' ' + fileContent;

                      var options = {
                          method: 'POST',
                          headers: {
                              'Content-Type': 'text/plain',
                          },
                          body: fileContent, // Use the modified file content as the body
                      };

                      try {
                          const resp = await fetch('/bin-cgi/uploader.py', options);
                          if (resp.ok) {
                              result.innerText = await resp.text();
                          } else {
                              console.error('Request failed with status:', resp.status);
                          }
                      } catch (error) {
                          console.error('An error occurred:', error);
                      }
                  };
                  // Read the file as text (you can choose a different type based on your file content)
                  reader.readAsText(file);
              });
          }

          // Call the function to set up the event listener
          sendPostRequest();
      </script>
  </div>

  <div class="row">
    <a href="/bin-cgi/downloader.py/images/orange.jpeg"><button>Download Data</button></a>
  </div>

  <div class="row">
    <button>Empty Button 1</button>
    <button>Empty Button 2</button>
  </div>
</div>
</body>
